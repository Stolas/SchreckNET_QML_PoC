# SchreckNET QML PoC - WebAssembly Client

This directory contains the HTML and JavaScript files needed to run the SchreckNET QML application in a web browser using Qt for WebAssembly.

## Files Overview

- **`appSchreckNET_QML_PoC.html`** - Main HTML file that loads and displays the Qt application
- **`appSchreckNET_QML_PoC.js`** - Generated WebAssembly JavaScript module (from Qt build)
- **`appSchreckNET_QML_PoC.wasm`** - WebAssembly binary (generated from Qt build)
- **`qtloader.js`** - Qt WebAssembly loader utility
- **`qtlogo.svg`** - Logo displayed during loading
- **`config.json`** - Configuration for deployment and build settings
- **`serve.py`** - Development web server with proper headers for WebAssembly
- **`README.md`** - This file

## Requirements

1. **Generated Files**: The `.js` and `.wasm` files need to be generated by building your Qt application with WebAssembly support.

2. **Web Server**: The application must be served over HTTP(S), not opened directly as a file. Use the provided `serve.py` or any web server that supports the required headers.

3. **Browser Support**: Modern browser with WebAssembly and SharedArrayBuffer support.

## Building the WebAssembly Files

To generate the required `.js` and `.wasm` files, build your Qt application for WebAssembly:

```bash
# Configure Qt for WebAssembly (from your build directory)
qt-cmake .. -DQT_HOST_PATH=/path/to/desktop/qt

# Build the application
cmake --build . --parallel

# The output files will be generated in your build directory
```

## Running the Application

### Using the Development Server

1. Copy the generated `.js` and `.wasm` files to this directory
2. Run the development server:

```bash
python3 serve.py 8080
```

3. Open your browser and navigate to:
```
http://localhost:8080/appSchreckNET_QML_PoC.html
```

### Using Other Web Servers

If using Apache, nginx, or another web server, ensure the following headers are set:

```
Cross-Origin-Embedder-Policy: require-corp
Cross-Origin-Opener-Policy: same-origin
```

And these MIME types:
```
.wasm -> application/wasm
.js   -> application/javascript
```

## File Structure After Build

```
src/client/
??? appSchreckNET_QML_PoC.html     # Main HTML file
??? appSchreckNET_QML_PoC.js       # Generated JS (from build)
??? appSchreckNET_QML_PoC.wasm     # Generated WASM (from build)
??? qtloader.js                    # Qt loader
??? qtlogo.svg                     # Loading screen logo
??? config.json                    # Configuration
??? serve.py                       # Development server
??? README.md                      # This file
```

## Customization

### Loading Screen
Edit the HTML file to customize:
- Logo (`qtlogo.svg` or replace with your own)
- Application title and description
- Loading screen styling
- Colors and fonts

### Qt Configuration
Modify the `qtConfig` object in the HTML file:
```javascript
window.qtConfig = {
    environment: {
        QT_QUICK_CONTROLS_STYLE: "Basic",
        QT_LOGGING_RULES: "*.debug=false"
    },
    showLoader: true,
    showCanvas: true,
    showExit: true
};
```

## Troubleshooting

### Common Issues

1. **"Failed to fetch" errors**
   - Ensure files are served over HTTP(S)
   - Check that all files exist in the same directory
   - Verify web server is running

2. **SharedArrayBuffer not available**
   - Check that proper headers are set
   - Use HTTPS or localhost (required for SharedArrayBuffer)
   - Ensure browser supports WebAssembly threads

3. **Application doesn't load**
   - Check browser console for errors
   - Verify the generated `.js` and `.wasm` files are present
   - Ensure Qt was built with WebAssembly support

4. **Performance issues**
   - Enable compression (gzip/brotli) on your web server
   - Use the optimized/release build of your Qt application
   - Consider using WebAssembly SIMD if supported

### Browser Requirements

Minimum browser versions:
- Chrome 79+
- Firefox 72+
- Safari 13.1+
- Edge 79+

Features required:
- WebAssembly
- SharedArrayBuffer (for multithreaded Qt apps)
- ES2020 support

## Development Tips

1. **Debug Mode**: Set `QT_LOGGING_RULES` to enable Qt debug output
2. **Hot Reload**: Rebuild and refresh to see changes
3. **Network Tools**: Use browser dev tools to monitor loading
4. **Console Logs**: Check console for Qt and WebAssembly messages

## Production Deployment

For production deployment:

1. **Enable compression** (gzip/brotli) for `.js` and `.wasm` files
2. **Set proper caching headers** for static assets
3. **Use CDN** for better global performance
4. **Monitor loading times** and optimize as needed
5. **Test on multiple browsers** and devices